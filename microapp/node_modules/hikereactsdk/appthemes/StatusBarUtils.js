import { Platform, StatusBar } from 'react-native';
import AppTheme from './AppTheme';

/**
 * Utils class to related status bar
 */
class StatusBarUtils {

  /**
   * Changes the the status bar color based on init props
   * @param appData
   *    init props recieved from hike app
   */
  static setStatusBarColor(appData) {
    if (appData && appData.passData) {
      let passData = appData.passData;
      try {
        if (typeof appData.passData === "string")
          passData = JSON.parse(appData.passData);
      }
      catch(e) {
      }

      if (passData.source === 'card') {
        StatusBarUtils.setFullScreenStatusBarProps(false);
        return;
      }
      else if (appData.sourceName === 'bvpalette') {
        StatusBarUtils.setFullScreenStatusBarProps(false);
        return;
      } else {
        StatusBarUtils.setFullScreenStatusBarProps(false);
        return;
      }
    }

    var isCard = false;
    if (appData && appData.triggerPoint === 'card') {
      isCard = true;
    }
    StatusBarUtils.setFullScreenStatusBarProps(isCard);
    return;
  }

  /**
   * Changes the status bar color and bg color based on whether it is a card or not.
   */
  static setFullScreenStatusBarProps(isCard) {
      if (Platform.OS === 'android') {
        console.log('isCard  ' + isCard);
          StatusBar.setTranslucent(isCard ? false : true);
          if (!isCard) {
            setTimeout(() => {
              StatusBar.setBackgroundColor('transparent');
            }, 500);
          }
          if (!isCard) {
          if (AppTheme.isZenTheme()) {
              StatusBar.setBarStyle('dark-content', true);
          } else {
              StatusBar.setBarStyle('light-content', true);
          }
        }
      }
    }
}

export default StatusBarUtils;